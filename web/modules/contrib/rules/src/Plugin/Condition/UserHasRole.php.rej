***************
*** 50,66 ****
     *   TRUE if the user has the role(s).
     */
    protected function doEvaluate(UserInterface $account, array $roles, $operation = 'AND') {
- 
-     $rids = array_map(function ($role) {
-       return $role->id();
-     }, $roles);
- 
      switch ($operation) {
        case 'OR':
-         return (bool) array_intersect($rids, $account->getRoles());
  
        case 'AND':
-         return (bool) !array_diff($rids, $account->getRoles());
  
        default:
          throw new InvalidArgumentException('Either use "AND" or "OR". Leave empty for default "AND" behavior.');
--- 50,61 ----
     *   TRUE if the user has the role(s).
     */
    protected function doEvaluate(UserInterface $account, array $roles, $operation = 'AND') {
      switch ($operation) {
        case 'OR':
+         return (bool) array_intersect($roles, $account->getRoles());
  
        case 'AND':
+         return (bool) !array_diff($roles, $account->getRoles());
  
        default:
          throw new InvalidArgumentException('Either use "AND" or "OR". Leave empty for default "AND" behavior.');
